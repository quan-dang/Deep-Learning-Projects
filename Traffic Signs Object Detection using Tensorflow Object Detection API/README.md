# Object Detection on LISA Traffica Signs Dataset using Faster R-CNN
Using Tensorfow Object Detection API to predict traffic signs.

## Structure description

__1. config/lisa_config.py__: store configurations, such as file paths, class labels, .etc.

__2. build_lisa_records.py__: accept an input set of images, create the
training and testing splits, and then create TensorFlow compatible record files that can be used for
training.

__3. predict.py__: apply our network to input images.

__4. predict_video.py__: apply our network to video files/streams.

__5. lisa__: contains all files relevant to the LISA Traffic Signs dataset such as the
raw images themselves and the serialized record files.

__6. lisa/records/training.record__: the serialized image dataset of images, bounding boxes, and labels
used for training.

__7. lisa/records/testing.record__: the images, bounding boxes, and labels used for testing.

__8. lisa/records/classes.pbtxt__: a plaintext file containing the names of the class labels and their unique
integer IDs.

__9. lisa/experiments/training/__: store the special pipeline configuration file used to instruct the
TFOD API how to train our model, the pre-trained model we’ll be using for fine-tuning, and any
model checkpoints created during training.

__10. lisa/experiments/evaluation/__: While training our network we’ll also be running an evaluation script provided by the TFOD
API — any logs generated by the evaluation script will be stored in the evaluation directory,
enabling us to use TensorFlow tools to graph and plot the training process using the special
TensorBoard utility. 

__11. lisa/experiments/exported_model/__: store the final exported, frozen weight model after training has
completed.

## How to run

__0. Step 0__: Download Lisa dataset and extract to the root project path, name it as lisa. Then, in the 'lisa' folder, create two subfolders 'records' and 'experiments'.
Inside 'experiments' folder, make 3 subfolders, i.e., 'training', 'evaluation' and 'exported_model'.

__1. Step 1__: Build the dataset and split a training and testing datasets.

```
python build_lisa_records.py
```

__2. Step 2__: Download [faster_rcnn_resnet101_coco_2018_01_28.tar.gz](https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md) and extract to __experiments/training__.

__3. Step 3__: Download [faster_rcnn_resnet101_pets.config](https://github.com/tensorflow/models/tree/master/research/object_detection/samples/configs) 
to __experiments/training__ and change its name to faster_rcnn_lisa.config, then open it to edit config for Faster-RCNN.

__4. Step 4__: Train R-CNN (go to the models/research to execute the command)

```
python object_detection/train.py --logtostderr 
--pipeline PATH_TO_ROOT_PROJECT/lisa/experiments/training/faster_rcnn_lisa.config 
--train_dir PATH_TO_ROOT_PROJECT/lisa/experiments/training
```

__5. Step 5__: Evaluate the network (go to the models/research to execute the command)

```
python object_detection/eval.py --logtostderr 
--pipeline_config_path PATH_TO_ROOT_PROJECT/lisa/experiments/training/faster_rcnn_lisa.config 
--checkpoint_dir PATH_TO_ROOT_PROJECT/lisa/experiments/training 
--eval_dir PATH_TO_ROOT_PROJECT/lisa/experiments/evaluation
```

__6. Step 6__: Predict a sample image

```
python predict.py
--model PATH_TO_ROOT_PROJECT/lisa/experiments/exported_model/frozen_inference_graph.pb
--labels PATH_TO_ROOT_PROJECT/lisa/records/classes.pbtxt
--image path/to/input/image.png
--num-classes 3
```





